{% extends 'atomic/base.html' %}

{% block title %}Dr. {{ doctor.user.get_full_name }} - MedLynk{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="card shadow-sm mb-4">
        <div class="card-body d-flex flex-column flex-md-row align-items-center gap-4">
            <div class="text-center">
                <div class="rounded-circle overflow-hidden" style="width: 140px; height: 140px; background: #f0f2ff;">
                    {% if doctor.user.profile_picture %}
                    <img src="{{ doctor.user.profile_picture.url }}" alt="Doctor photo" class="img-fluid" style="object-fit: cover; width: 100%; height: 100%;">
                    {% else %}
                    <i class="bi bi-person-badge" style="font-size: 5rem; line-height: 140px; color: #667eea;"></i>
                    {% endif %}
                </div>
            </div>
            <div class="flex-grow-1">
                <h2 class="mb-1">Dr. {{ doctor.user.get_full_name }}</h2>
                <p class="text-muted mb-2">{{ doctor.specialization }}</p>
                <div class="d-flex flex-wrap gap-3 align-items-center">
                    <div>
                        <strong>{{ average_rating|floatformat:1 }}</strong>
                        <small class="text-muted">/ 5.0</small>
                        <small class="text-muted ms-1">({{ rating_count }} reviews)</small>
                    </div>
                    {% if profile and profile.is_available %}
                    <span class="badge bg-success">Available Today</span>
                    {% else %}
                    <span class="badge bg-secondary">Not Available</span>
                    {% endif %}
                    {% if profile and profile.years_of_experience %}
                    <span class="badge bg-info text-dark">{{ profile.years_of_experience }} yrs experience</span>
                    {% endif %}
                </div>
            </div>
            <div>
                <a href="{% url 'appointments:appointment_create' %}?doctor={{ doctor.id }}" class="btn btn-primary">
                    <i class="bi bi-calendar-plus"></i> Book Appointment
                </a>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <h4 class="mb-3"><i class="bi bi-person-lines-fill"></i> About</h4>
                    <p class="text-muted mb-0">
                        {{ doctor.bio|default:"This doctor has not added a biography yet." }}
                    </p>
                </div>
            </div>

            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <h4 class="mb-3"><i class="bi bi-briefcase"></i> Professional Information</h4>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <small class="text-muted text-uppercase">Specialization</small>
                            <p class="mb-0">{{ profile.specialization|default:doctor.specialization }}</p>
                        </div>
                        <div class="col-md-6">
                            <small class="text-muted text-uppercase">License Number</small>
                            <p class="mb-0">{{ profile.license_number|default:doctor.license_number|default:"Not provided" }}</p>
                        </div>
                        <div class="col-md-6">
                            <small class="text-muted text-uppercase">Consultation Fee</small>
                            <p class="mb-0">₱{{ doctor.consultation_fee }}</p>
                        </div>
                        <div class="col-md-6">
                            <small class="text-muted text-uppercase">Education</small>
                            <p class="mb-0">{{ profile.education|default:"Not provided" }}</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card shadow-sm">
                <div class="card-body">
                    <h4 class="mb-4"><i class="bi bi-chat-left-quote"></i> Patient Reviews</h4>
                    {% if ratings %}
                        {% for review in ratings %}
                        <div class="border rounded-3 p-3 mb-3">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <strong>{{ review.patient.get_full_name }}</strong>
                                <span class="text-warning">
                                    {% for i in "12345" %}
                                        {% if forloop.counter <= review.rating %}
                                        <i class="bi bi-star-fill"></i>
                                        {% else %}
                                        <i class="bi bi-star"></i>
                                        {% endif %}
                                    {% endfor %}
                                </span>
                            </div>
                            <p class="mb-0">{{ review.comment|default:"No feedback provided." }}</p>
                            <small class="text-muted">{{ review.created_at|date:"M d, Y" }}</small>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="text-muted mb-0">No reviews yet.</p>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="mb-3">Quick Stats</h5>
                    <div class="row text-center g-2">
                        <div class="col-6">
                            <div class="border rounded p-3">
                                <div class="h4 mb-0">{{ profile.years_of_experience|default:"N/A" }}</div>
                                <small class="text-muted">Years Exp.</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="border rounded p-3">
                                <div class="h4 mb-0">{{ total_patients }}</div>
                                <small class="text-muted">Patients</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="border rounded p-3">
                                <div class="h4 mb-0">{{ rating_count }}</div>
                                <small class="text-muted">Reviews</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="border rounded p-3">
                                <div class="h4 mb-0">{{ total_appointments }}</div>
                                <small class="text-muted">Consultations</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="mb-3"><i class="bi bi-telephone"></i> Contact Information</h5>
                    <p class="mb-2">
                        <strong>Phone:</strong><br>
                        <span class="text-muted">{{ doctor.user.phone_number|default:"Not provided" }}</span>
                    </p>
                    <p class="mb-0">
                        <strong>Email:</strong><br>
                        <span class="text-muted">{{ doctor.user.email }}</span>
                    </p>
                </div>
            </div>

            <a href="{% url 'doctors:doctor_list' %}" class="btn btn-outline-secondary w-100">
                <i class="bi bi-arrow-left"></i> Back to Doctor List
            </a>
        </div>
    </div>
</div>
{% endblock %}
{% extends 'atomic/base.html' %}
{% load static %}

{% block title %}{{ doctor.name|default:"Dr. Maria Santos" }} - MedLynk{% endblock %}

{% block extra_css %}
<style>
    .doctor-profile-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 3rem 0;
        margin-bottom: 2rem;
        border-radius: 0 0 30px 30px;
    }

    .doctor-avatar-large {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        background: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 4rem;
        color: #667eea;
        margin: 0 auto 1.5rem;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }

    .rating-stars {
        color: #ffc107;
        font-size: 1.25rem;
    }

    .info-card {
        background: white;
        border-radius: 15px;
        padding: 2rem;
        box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        margin-bottom: 1.5rem;
    }

    .stat-box {
        text-align: center;
        padding: 1.5rem;
        background: #f8f9fa;
        border-radius: 10px;
        transition: all 0.3s ease;
    }

        .stat-box:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-5px);
        }

    .stat-number {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 0.5rem;
    }

    .stat-label {
        font-size: 0.875rem;
        opacity: 0.8;
    }

    .schedule-slot {
        padding: 0.75rem;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
    }

        .schedule-slot:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .schedule-slot.available {
            border-color: #28a745;
            background: #f0fff4;
        }

        .schedule-slot.booked {
            border-color: #dc3545;
            background: #fff5f5;
            opacity: 0.6;
            cursor: not-allowed;
        }

    .review-card {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 1.5rem;
        margin-bottom: 1rem;
    }

    .review-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
    }

    .reviewer-name {
        font-weight: 600;
        color: #333;
    }

    .review-date {
        color: #999;
        font-size: 0.875rem;
    }

    .specialization-tag {
        display: inline-block;
        padding: 0.5rem 1rem;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 20px;
        margin: 0.25rem;
        font-size: 0.875rem;
    }

    .book-appointment-btn {
        padding: 1rem 2rem;
        font-size: 1.125rem;
        border-radius: 10px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        transition: all 0.3s ease;
    }

        .book-appointment-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }
</style>
{% endblock %}

{% block content %}
<!-- Doctor Profile Header -->
<div class="doctor-profile-header">
    <div class="container">
        <div class="text-center">
            <div class="doctor-avatar-large">
                <i class="bi bi-person-circle"></i>
            </div>
            <h1 class="mb-2">{{ doctor.name|default:"Dr. Maria Santos" }}</h1>
            <p class="mb-3" style="font-size: 1.25rem;">{{ doctor.specialization|default:"General Medicine Specialist" }}</p>

            <div class="rating-stars mb-2">
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-fill"></i>
                <i class="bi bi-star-half"></i>
                <span class="ms-2">4.8 (124 reviews)</span>
            </div>

            <div class="d-flex justify-content-center gap-3 mt-4">
                {% include 'atomic/atoms/badge.html' with text="Available Today" type="success" %}
                {% include 'atomic/atoms/badge.html' with text="15+ years experience" type="info" %}
            </div>
        </div>
    </div>
</div>

<div class="container py-4">
    <div class="row">
        <!-- Main Content -->
        <div class="col-lg-8">
            <!-- About Section -->
            <div class="info-card">
                <h4 class="mb-3"><i class="bi bi-person"></i> About Doctor</h4>
                <p class="text-muted">
                    {{ doctor.bio|default:"Dr. Maria Santos is a highly experienced General Medicine Specialist with over 15 years of practice. She completed her medical degree at the University of the Philippines and has since dedicated her career to providing comprehensive healthcare services. Dr. Santos is known for her compassionate approach and thorough patient care." }}
                </p>
                <p class="text-muted">
                    She specializes in preventive medicine, chronic disease management, and general health consultations. Dr. Santos believes in building long-term relationships with her patients and emphasizes patient education in all her consultations.
                </p>
            </div>

            <!-- Specializations -->
            <div class="info-card">
                <h4 class="mb-3"><i class="bi bi-award"></i> Specializations</h4>
                <div>
                    <span class="specialization-tag">General Medicine</span>
                    <span class="specialization-tag">Preventive Care</span>
                    <span class="specialization-tag">Chronic Disease Management</span>
                    <span class="specialization-tag">Health Screening</span>
                    <span class="specialization-tag">Vaccination</span>
                </div>
            </div>

            <!-- Education & Credentials -->
            <div class="info-card">
                <h4 class="mb-3"><i class="bi bi-mortarboard"></i> Education & Credentials</h4>

                <div class="mb-3">
                    <h6 class="mb-1"><i class="bi bi-check-circle-fill text-success"></i> Medical Degree</h6>
                    <p class="text-muted mb-0">University of the Philippines College of Medicine (2008)</p>
                </div>

                <div class="mb-3">
                    <h6 class="mb-1"><i class="bi bi-check-circle-fill text-success"></i> Residency</h6>
                    <p class="text-muted mb-0">Philippine General Hospital - Internal Medicine (2012)</p>
                </div>

                <div class="mb-3">
                    <h6 class="mb-1"><i class="bi bi-check-circle-fill text-success"></i> Board Certification</h6>
                    <p class="text-muted mb-0">Philippine Board of Internal Medicine (2013)</p>
                </div>

                <div>
                    <h6 class="mb-1"><i class="bi bi-check-circle-fill text-success"></i> License</h6>
                    <p class="text-muted mb-0">PRC License No. 0123456 (Valid until 2026)</p>
                </div>
            </div>

            <!-- Weekly Schedule -->
            <div class="info-card">
                <h4 class="mb-3"><i class="bi bi-calendar-week"></i> Weekly Schedule</h4>

                <div class="row g-2">
                    <div class="col-md-4">
                        <div class="schedule-slot available">
                            <strong>Monday</strong><br>
                            <small>9:00 AM - 5:00 PM</small><br>
                            <span class="badge bg-success mt-1">Available</span>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="schedule-slot available">
                            <strong>Tuesday</strong><br>
                            <small>9:00 AM - 5:00 PM</small><br>
                            <span class="badge bg-success mt-1">Available</span>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="schedule-slot available">
                            <strong>Wednesday</strong><br>
                            <small>9:00 AM - 5:00 PM</small><br>
                            <span class="badge bg-success mt-1">Available</span>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="schedule-slot available">
                            <strong>Thursday</strong><br>
                            <small>9:00 AM - 5:00 PM</small><br>
                            <span class="badge bg-success mt-1">Available</span>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="schedule-slot available">
                            <strong>Friday</strong><br>
                            <small>9:00 AM - 3:00 PM</small><br>
                            <span class="badge bg-success mt-1">Available</span>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="schedule-slot booked">
                            <strong>Weekend</strong><br>
                            <small>Closed</small><br>
                            <span class="badge bg-secondary mt-1">Not Available</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Patient Reviews -->
            <div class="info-card">
                <h4 class="mb-4"><i class="bi bi-chat-left-quote"></i> Patient Reviews (124)</h4>

                <div class="review-card">
                    <div class="review-header">
                        <div>
                            <div class="reviewer-name">Juan Dela Cruz</div>
                            <div class="rating-stars" style="font-size: 1rem;">
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                            </div>
                        </div>
                        <div class="review-date">2 days ago</div>
                    </div>
                    <p class="mb-0">Excellent doctor! Very thorough and takes time to explain everything. Highly recommended.</p>
                </div>

                <div class="review-card">
                    <div class="review-header">
                        <div>
                            <div class="reviewer-name">Maria Garcia</div>
                            <div class="rating-stars" style="font-size: 1rem;">
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-half"></i>
                            </div>
                        </div>
                        <div class="review-date">1 week ago</div>
                    </div>
                    <p class="mb-0">Very professional and caring. Made me feel comfortable during my consultation.</p>
                </div>

                <div class="review-card">
                    <div class="review-header">
                        <div>
                            <div class="reviewer-name">Pedro Santos</div>
                            <div class="rating-stars" style="font-size: 1rem;">
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                                <i class="bi bi-star-fill"></i>
                            </div>
                        </div>
                        <div class="review-date">2 weeks ago</div>
                    </div>
                    <p class="mb-0">Best doctor I've ever had! Great bedside manner and really listens to concerns.</p>
                </div>

                <button class="btn btn-outline-primary btn-sm mt-3">
                    <i class="bi bi-plus-circle"></i> Load More Reviews
                </button>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="col-lg-4">
            <!-- Quick Stats -->
            <div class="info-card">
                <h5 class="mb-3">Quick Stats</h5>

                <div class="row g-2">
                    <div class="col-6">
                        <div class="stat-box">
                            <div class="stat-number">15+</div>
                            <div class="stat-label">Years Exp.</div>
                        </div>
                    </div>

                    <div class="col-6">
                        <div class="stat-box">
                            <div class="stat-number">5,000+</div>
                            <div class="stat-label">Patients</div>
                        </div>
                    </div>

                    <div class="col-6">
                        <div class="stat-box">
                            <div class="stat-number">124</div>
                            <div class="stat-label">Reviews</div>
                        </div>
                    </div>

                    <div class="col-6">
                        <div class="stat-box">
                            <div class="stat-number">4.8</div>
                            <div class="stat-label">Rating</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Book Appointment -->
            <div class="info-card text-center">
                <h5 class="mb-3">Book an Appointment</h5>
                <p class="text-muted mb-4">Next available: <strong>Tomorrow, 10:00 AM</strong></p>

                <a href="{% url 'appointments:appointment_create' %}" class="btn btn-primary book-appointment-btn w-100">
                    <i class="bi bi-calendar-plus"></i> Book Now
                </a>
            </div>

            <!-- Contact Information -->
            <div class="info-card">
                <h5 class="mb-3"><i class="bi bi-telephone"></i> Contact</h5>

                <div class="mb-3">
                    <small class="text-muted">Phone</small>
                    <p class="mb-0"><strong>+63 912 345 6789</strong></p>
                </div>

                <div class="mb-3">
                    <small class="text-muted">Email</small>
                    <p class="mb-0"><strong>dr.santos@medlynk.com</strong></p>
                </div>

                <div>
                    <small class="text-muted">Clinic Location</small>
                    <p class="mb-0">
                        <strong>MedLynk Clinic - Main Branch</strong><br>
                        123 Health Street<br>
                        Malolos, Bulacan 3000
                    </p>
                </div>

                <button class="btn btn-outline-primary btn-sm w-100 mt-3">
                    <i class="bi bi-map"></i> View on Map
                </button>
            </div>

            <!-- Consultation Fee -->
            <div class="info-card">
                <h5 class="mb-3"><i class="bi bi-currency-dollar"></i> Consultation Fee</h5>

                <div class="text-center">
                    <h2 class="mb-2" style="color: #667eea;">₱800</h2>
                    <p class="text-muted mb-0">Per consultation</p>
                </div>

                <hr class="my-3">

                <small class="text-muted">
                    <i class="bi bi-info-circle"></i>
                    Fee includes initial consultation and basic diagnostic review
                </small>
            </div>

            <!-- Back Button -->
            <a href="{% url 'doctors:doctor_list' %}" class="btn btn-outline-secondary w-100">
                <i class="bi bi-arrow-left"></i> Back to Doctor List
            </a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Add click handlers for schedule slots
    document.querySelectorAll('.schedule-slot.available').forEach(slot => {
        slot.addEventListener('click', function() {
            if (confirm('Would you like to book an appointment for this day?')) {
                window.location.href = '{% url "appointments:appointment_create" %}';
            }
        });
    });
</script>
{% endblock %}